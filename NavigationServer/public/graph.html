<!DOCTYPE html>
<html lang="en">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.css" />
<script
        src="https://code.jquery.com/jquery-3.1.1.js"
        integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA="
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.11/c3.js"></script>

<style>
    .result_box {
        height:20em;
        width: 90vw;
        border-style: solid;
        padding: 0.5em;
    }

    #result_table {
        overflow: scroll;
    }

    #query_settings_container {
        display: block;
        border: lightgray dotted;
        width: 15em;
        height: 20em;
    }

    #standard_query_settings_container {
        display: block;
        border: lightgray dotted;
        width: 20em;
        height: 20em;
    }

    .preset_query {
    }

</style>

<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <h4>Graph</h4>
    <div id="c3_graph" class="result_box"></div>

    <h4> Data </h4>
    <div id="result_table" class="result_box"></div>

    <table>
        <tr>
            <td>
                <div id="query_settings_container">
                    <h4> Query Settings </h4>

                    <p> Start Date </p>
                    <input type="datetime-local" id="start_date" value="2017-02-24T00:00">

                    <p> End Date </p>
                    <input type="datetime-local" id="end_date" value="2017-02-25T00:00">

                    <p> Observation Type </p>
                    <select id="observation_type">
                        <option value="hotspot">Hotspot</option>
                        <option value="bluetooth">Bluetooth</option>
                        <option value="crowd">Crowd</option>
                        <option value="accelerometer">Accelerometer</option>
                        <option value="audio">Audio</option>
                    </select>

                    <p></p>
                    <button onclick="getData()"> Get Data </button>
                </div>
            </td>
            <td>
                <div id="standard_query_settings_container">
                    <h4> Standard Query Settings </h4>

                    <div class="preset_query">
                        <span> 13:05 - 13:10 quiet cs atrium </span>
                        <button onclick="preSet('2017-02-24T13:05','2017-02-24T13:10')"> Set </button>
                    </div>

                    <div class="preset_query">
                        <span> 13:16 - 13:22 busy a32 </span>
                        <button onclick="preSet('2017-02-24T13:16','2017-02-24T13:22')"> Set </button>
                    </div>

                    <div class="preset_query">
                        <span> 13:40 - 13:45 walking outside on jubilee </span>
                        <button onclick="preSet('2017-02-24T13:40','2017-02-24T13:45')"> Set </button>
                    </div>

                    <div class="preset_query">
                        <span> 13:53 - 14:50 jubilee sports center </span>
                        <button onclick="preSet('2017-02-24T13:53','2017-02-24T14:50')"> Set </button>
                    </div>

                </div>
            </td>
        </tr>
    </table>


</body>
</html>

<script>

    var chart = c3.generate({
        bindto: '#c3_graph',
        data: {
            columns: [
                ['data1', 30, 200, 100, 400, 150, 250],
                ['data2', 50, 20, 10, 40, 15, 25]
            ]
        }
    });

    function getData() {
        var start_date = $('#start_date').val();
        var end_date = $('#end_date').val();
        var observation_type = $('#observation_type').val();

        if(!start_date || !end_date || !observation_type) {
            alert("You have not completed all of the required values");
            //alert("start_date: " + start_date + "\n end_date: " + end_date + "\n observation_type: " + observation_type);
        }

        var get_url = "http://54.154.109.216/observations/";

        get_url += observation_type;
        get_url += "/";
        get_url += start_date;
        get_url += "/";
        get_url += end_date;
        get_url += "?apitoken=koH6a1UC71rTDM1LKppXeKYJ54cjc8nIfuJAKPly1GDYpjMMLLCuK5LBp3fXAEkCcID1jCh5pCQp9D8DmCWhJHQlLcUcy4gD68Qy";

        $.get(get_url, function(data, status){
            //alert("Data: " + data + "\nStatus: " + status);
            $('#result_table').html(JSON.stringify(data));
        });

    }

    function preSet(start_date, end_date) {
        $('#start_date').val(start_date);
        $('#end_date').val(end_date);
        getData();
    }

</script>